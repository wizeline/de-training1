{
   "paragraphs": [
       {
           "text": "%md\n# Performing Data Partitioning in Spark\n\nWelcome to the notebook with the exercises for the fifth session.\n\nIf you have any feedback about our courses, email us at academy@wizeline.com or use the Academy Slack channel.",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:26:26+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true,
                   "completionSupport": false
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<h1>Performing Data Partitioning in Spark</h1>\n<p>Welcome to the notebook with the exercises for the fifth session.</p>\n<p>If you have any feedback about our courses, email us at <a href=\"mailto:&#97;c&#97;&#x64;&#x65;&#x6d;&#x79;&#64;&#x77;&#x69;z&#101;&#x6c;&#105;n&#101;&#46;&#99;o&#109;\">&#97;c&#97;&#x64;&#x65;&#x6d;&#x79;&#64;&#x77;&#x69;z&#101;&#x6c;&#105;n&#101;&#46;&#99;o&#109;</a> or use the Academy Slack channel.</p>\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691556_1532213398",
           "id": "20180824-154704_999864938",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "FINISHED",
           "progressUpdateIntervalMs": 500,
           "focus": true,
           "$$hashKey": "object:229",
           "dateFinished": "2019-05-06T19:26:29+0000",
           "dateStarted": "2019-05-06T19:26:26+0000"
       },
       {
           "text": "%md\n## Overview\nIn this notebook you will be doing four examples/exercises aimed at:\n\n+ Looking at the data distribution of the partitions stored in your cluster.\n+ Using different partitioning approaches to understand which is the best according to your dataset.\n+ Understanding the impact of the partitioning on the Input/Output (I/O) functions.\n",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:27:04+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true,
                   "completionSupport": false
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<h2>Overview</h2>\n<p>In this notebook you will be doing four examples/exercises aimed at:</p>\n<ul>\n  <li>Looking at the data distribution of the partitions stored in your cluster.</li>\n  <li>Using different partitioning approaches to understand which is the best according to your dataset.</li>\n  <li>Understanding the impact of the partitioning on the Input/Output (I/O) functions.</li>\n</ul>\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691574_-891891591",
           "id": "20180913-162107_1481179539",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "FINISHED",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:230",
           "dateFinished": "2019-05-06T19:27:04+0000",
           "dateStarted": "2019-05-06T19:27:04+0000"
       },
       {
           "title": "",
           "text": "%md\n# Example 1 - Partitions and Data Distribution\n\nIn this exercise, you will look at the data contained in different partitions. Pay attention to how the data is distributed between the partitions, depending on how they are created.\n\nYou will use the sample `Dataset` named `transactions`, which contains monetary transactions for users in the world.\n",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:27:29+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true,
                   "completionSupport": false
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "title": false,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<h1>Example 1 - Partitions and Data Distribution</h1>\n<p>In this exercise, you will look at the data contained in different partitions. Pay attention to how the data is distributed between the partitions, depending on how they are created.</p>\n<p>You will use the sample <code>Dataset</code> named <code>transactions</code>, which contains monetary transactions for users in the world.</p>\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691575_2103097900",
           "id": "20180824-160322_654860629",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "FINISHED",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:231",
           "dateFinished": "2019-05-06T19:27:29+0000",
           "dateStarted": "2019-05-06T19:27:29+0000"
       },
       {
           "text": "%md <img src=\"https://image.ibb.co/nRs6Nz/scala.png\" alt=\"Scala\">",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<img src=\"https://image.ibb.co/nRs6Nz/scala.png\" alt=\"Scala\">\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691576_-690477128",
           "id": "20180913-193054_1221171060",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:232"
       },
       {
           "text": "case class Transactions(name:String, amount:Long, country:String)\n\nval transactions = List(\n    Transactions(\"Bob\", 25, \"MX\"),\n    Transactions(\"James\", 15, \"United Kingdom\"),\n    Transactions(\"Marek\", 51, \"Poland\"),\n    Transactions(\"Johannes\", 200,\"Germany\"),\n    Transactions(\"Paul\", 75, \"Poland\"),\n    Transactions(\"Bob\", 35, \"Mexico\"),\n    Transactions(\"James\", 21, \"Germany\")\n)",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "colWidth": 12,
               "editorMode": "ace/mode/scala",
               "results": {},
               "enabled": true,
               "editorSetting": {
                   "language": "scala",
                   "editOnDblClick": false,
                   "completionKey": "TAB",
                   "completionSupport": true
               },
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "apps": [],
           "jobName": "paragraph_1557170691577_1502887946",
           "id": "20180827-172331_1658203493",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:233"
       },
       {
           "text": "%md <img src=\"https://image.ibb.co/k8qhvK/python.png\" alt=\"Python\">",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<img src=\"https://image.ibb.co/k8qhvK/python.png\" alt=\"Python\">\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691578_-1013572788",
           "id": "20180913-193112_889574352",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:234"
       },
       {
           "text": "%pyspark\n\ntransaction_schema = ['name', 'amount', 'country']\n\ntransactions = [\n    ('Bob', 100, 'United Kingdom'),\n    ('James', 15, 'United Kingdom'),\n    ('Marek', 51, 'Poland'),\n    ('Johannes', 200, 'Germany'),\n    ('Paul', 75, 'Poland'),\n    ('Bob', 35, 'Mexico'),\n    ('James', 21, 'Germany')\n]",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "colWidth": 12,
               "editorMode": "ace/mode/python",
               "results": {},
               "enabled": true,
               "editorSetting": {
                   "language": "python",
                   "editOnDblClick": false,
                   "completionKey": "TAB",
                   "completionSupport": true
               },
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "apps": [],
           "jobName": "paragraph_1557170691579_1805761808",
           "id": "20180824-160727_1105840180",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:235"
       },
       {
           "text": "%md\n\nThe following snippets define a function to print the number of partitions, the kind of partitioner being used, and the partition structure in a `Dataframe`. We will use it in many examples and exercises in this notebook:",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:29:35+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true,
                   "completionSupport": false
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<p>The following snippets define a function to print the number of partitions, the kind of partitioner being used, and the partition structure in a <code>Dataframe</code>. We will use it in many examples and exercises in this notebook:</p>\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691580_-1289401004",
           "id": "20180824-161222_1775895785",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "FINISHED",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:236",
           "dateFinished": "2019-05-06T19:29:35+0000",
           "dateStarted": "2019-05-06T19:29:35+0000"
       },
       {
           "text": "%md <img src=\"https://image.ibb.co/nRs6Nz/scala.png\" alt=\"Scala\">",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<img src=\"https://image.ibb.co/nRs6Nz/scala.png\" alt=\"Scala\">\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691591_1781135705",
           "id": "20180913-193218_437502423",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:237"
       },
       {
           "text": "import org.apache.spark.sql.{DataFrame, Row}\n\ndef printPartitionsInfo(dataframe: DataFrame, skipEmpty: Boolean = true) = {\n    val partitions = dataframe.rdd.mapPartitionsWithIndex((index: Int, iter: Iterator[Row]) => {\n        List((index, iter.toList)).toIterator\n    }).collect\n    val displayablePartitions = \n        if (!skipEmpty) partitions \n        else partitions.filter(partition => partition._2.length > 0)\n    \n    println(\"--------------------------------------------------------------------\")\n    println(s\"Number of partitions: ${dataframe.rdd.getNumPartitions}\")\n    println(s\"Partitioner: ${dataframe.rdd.partitioner.toString}\")\n    println(s\"Partitions structure: \")\n    println(displayablePartitions.mkString(\"\\n\"))\n    println(\"--------------------------------------------------------------------\")\n}",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "colWidth": 12,
               "editorMode": "ace/mode/scala",
               "results": {},
               "enabled": true,
               "editorSetting": {
                   "language": "scala",
                   "editOnDblClick": false,
                   "completionKey": "TAB",
                   "completionSupport": true
               },
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "apps": [],
           "jobName": "paragraph_1557170691592_1722327517",
           "id": "20180913-164046_1992179228",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:238"
       },
       {
           "text": "import org.apache.spark.sql.Row\n\nval df = spark.createDataFrame(transactions)\nprintPartitionsInfo(df)",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "colWidth": 12,
               "editorMode": "ace/mode/scala",
               "results": {},
               "enabled": true,
               "editorSetting": {
                   "language": "scala",
                   "editOnDblClick": false,
                   "completionKey": "TAB",
                   "completionSupport": true
               },
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "apps": [],
           "jobName": "paragraph_1557170691592_-170210252",
           "id": "20180827-182233_1620123781",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:239"
       },
       {
           "text": "%md <img src=\"https://image.ibb.co/k8qhvK/python.png\" alt=\"Python\">",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<img src=\"https://image.ibb.co/k8qhvK/python.png\" alt=\"Python\">\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691593_264657265",
           "id": "20180913-193229_1542503448",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:240"
       },
       {
           "text": "%pyspark\n\ndef print_partitions_info(dataframe, skip_empty=False):\n    partitions = \\\n        dataframe.rdd \\\n            .mapPartitionsWithIndex(lambda index, iterator: [(index, list(iterator))]) \\\n            .collect()\n    if skip_empty:\n        partitions = (partition for partition in partitions if len(partition[1]) > 0)\n\n    partitions = '\\n'.join(map(str, partitions))\n    print(\"Number of partitions: {}\".format(dataframe.rdd.getNumPartitions()))\n    print(\"Partitioner: {}\".format(dataframe.rdd.partitioner))\n    print(\"Partitions structure: \")\n    print(partitions)",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "colWidth": 12,
               "editorMode": "ace/mode/python",
               "results": {},
               "enabled": true,
               "editorSetting": {
                   "language": "python",
                   "editOnDblClick": false,
                   "completionKey": "TAB",
                   "completionSupport": true
               },
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "apps": [],
           "jobName": "paragraph_1557170691593_828013894",
           "id": "20180913-163950_1113232990",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:241"
       },
       {
           "text": "%pyspark\n\nfrom pyspark.sql import SparkSession, Row\n\ndf = spark.createDataFrame(transactions, transaction_schema)\nprint_partitions_info(df)",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "colWidth": 12,
               "editorMode": "ace/mode/python",
               "results": {},
               "enabled": true,
               "editorSetting": {
                   "language": "python",
                   "editOnDblClick": false,
                   "completionKey": "TAB",
                   "completionSupport": true
               },
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "apps": [],
           "jobName": "paragraph_1557170691594_-1043570690",
           "id": "20180824-161021_1826354548",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:242"
       },
       {
           "text": "%md\n## Exercise\n\nLook at the output from the previous example and answer the following questions:\n\n+ Which names ended up on partition 1?\n+ Which amounts ended up on partition 2\n+ Why is the partitioner `None`? Do some research online and discuss with your classmates and instructor(s).",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:29:53+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true,
                   "completionSupport": false
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<h2>Exercise</h2>\n<p>Look at the output from the previous example and answer the following questions:</p>\n<ul>\n  <li>Which names ended up on partition 1?</li>\n  <li>Which amounts ended up on partition 2</li>\n  <li>Why is the partitioner <code>None</code>? Do some research online and discuss with your classmates and instructor(s).</li>\n</ul>\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691597_117837688",
           "id": "20180824-161209_564012877",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "FINISHED",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:243",
           "dateFinished": "2019-05-06T19:29:53+0000",
           "dateStarted": "2019-05-06T19:29:53+0000"
       },
       {
           "text": "%md\n**REPARTITIONING:**\nThe following code repartitions the original DataFrame and outputs the same information.",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:28:52+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true,
                   "completionSupport": false
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<p><strong>REPARTITIONING:</strong><br/>The following code repartitions the original DataFrame and outputs the same information.</p>\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691598_645656768",
           "id": "20180824-161118_605198725",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "FINISHED",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:244",
           "dateFinished": "2019-05-06T19:28:52+0000",
           "dateStarted": "2019-05-06T19:28:52+0000"
       },
       {
           "text": "%md <img src=\"https://image.ibb.co/nRs6Nz/scala.png\" alt=\"Scala\">",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<img src=\"https://image.ibb.co/nRs6Nz/scala.png\" alt=\"Scala\">\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691599_935160926",
           "id": "20180913-193258_912953345",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:245"
       },
       {
           "text": "val dfByCountry = df.repartition($\"country\")\nprintPartitionsInfo(dfByCountry, skipEmpty=true)",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "colWidth": 12,
               "editorMode": "ace/mode/scala",
               "results": {
                   "0": {
                       "graph": {
                           "mode": "table",
                           "height": 125,
                           "optionOpen": false
                       }
                   }
               },
               "enabled": true,
               "editorSetting": {
                   "language": "scala",
                   "editOnDblClick": false,
                   "completionKey": "TAB",
                   "completionSupport": true
               },
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "apps": [],
           "jobName": "paragraph_1557170691600_2143098592",
           "id": "20180827-191139_22040351",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:246"
       },
       {
           "text": "%md <img src=\"https://image.ibb.co/k8qhvK/python.png\" alt=\"Python\">",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<img src=\"https://image.ibb.co/k8qhvK/python.png\" alt=\"Python\">\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691600_1013823774",
           "id": "20180913-193309_1085062117",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:247"
       },
       {
           "text": "%pyspark\n\ndf_by_country = df.repartition(\"country\")\nprint_partitions_info(df_by_country, skip_empty=True)",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "colWidth": 12,
               "editorMode": "ace/mode/python",
               "results": {},
               "enabled": true,
               "editorSetting": {
                   "language": "python",
                   "editOnDblClick": false,
                   "completionKey": "TAB",
                   "completionSupport": true
               },
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "apps": [],
           "jobName": "paragraph_1557170691601_397485489",
           "id": "20180824-161919_1765365187",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:248"
       },
       {
           "text": "%md\n\nRemember more `partitions != uniform partition distribution`. So, the answer  is not more partitions necessarily.In fact, if you end up having too many partitions you may bump into a problem with very small files.",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:30:13+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true,
                   "completionSupport": false
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<p>Remember more <code>partitions != uniform partition distribution</code>. So, the answer is not more partitions necessarily.In fact, if you end up having too many partitions you may bump into a problem with very small files.</p>\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691601_-94046905",
           "id": "20180824-163234_318434487",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "FINISHED",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:249",
           "dateFinished": "2019-05-06T19:30:13+0000",
           "dateStarted": "2019-05-06T19:30:13+0000"
       },
       {
           "text": "%md\n## Exercise\n\n+ Which names ended up on partition 1?\n+ Which amounts ended up on partition 2\n+ What differences do you notice here compared to the previous exercise?\n\nDiscuss with your classmates or your mentor and instructor(s) if necessary.\n",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:31:03+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true,
                   "completionSupport": false
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<h2>Exercise</h2>\n<ul>\n  <li>Which names ended up on partition 1?</li>\n  <li>Which amounts ended up on partition 2</li>\n  <li>What differences do you notice here compared to the previous exercise?</li>\n</ul>\n<p>Discuss with your classmates or your mentor and instructor(s) if necessary.</p>\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691602_1887469543",
           "id": "20180913-163720_1416505055",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "FINISHED",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:250",
           "dateFinished": "2019-05-06T19:31:03+0000",
           "dateStarted": "2019-05-06T19:31:03+0000"
       },
       {
           "text": "%md\n# Example 2 - Partitioning Approaches\n\nUsing the same dataset, create new datasets by partitioning. You have to use each one of the columns. This means you will end with 4 distinct datasets.",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:31:19+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true,
                   "completionSupport": false
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<h1>Example 2 - Partitioning Approaches</h1>\n<p>Using the same dataset, create new datasets by partitioning. You have to use each one of the columns. This means you will end with 4 distinct datasets.</p>\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691608_43082149",
           "id": "20180824-163253_580541449",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "FINISHED",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:251",
           "dateFinished": "2019-05-06T19:31:19+0000",
           "dateStarted": "2019-05-06T19:31:19+0000"
       },
       {
           "text": "%md <img src=\"https://image.ibb.co/nRs6Nz/scala.png\" alt=\"Scala\">",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<img src=\"https://image.ibb.co/nRs6Nz/scala.png\" alt=\"Scala\">\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691609_-936007526",
           "id": "20180913-193332_1003160714",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:252"
       },
       {
           "text": "val dfByName = df.repartition($\"name\")\nprintPartitionsInfo(dfByName, skipEmpty=true)",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "colWidth": 12,
               "editorMode": "ace/mode/scala",
               "results": {},
               "enabled": true,
               "editorSetting": {
                   "language": "scala",
                   "editOnDblClick": false,
                   "completionKey": "TAB",
                   "completionSupport": true
               },
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "apps": [],
           "jobName": "paragraph_1557170691609_2121243252",
           "id": "20180827-192209_233833264",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:253"
       },
       {
           "text": "%md <img src=\"https://image.ibb.co/k8qhvK/python.png\" alt=\"Python\">",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<img src=\"https://image.ibb.co/k8qhvK/python.png\" alt=\"Python\">\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691610_-1521076447",
           "id": "20180913-193343_1919682855",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:254"
       },
       {
           "text": "%pyspark\n\ndf_by_name = df.repartition(\"name\")\nprint_partitions_info(df_by_name, skip_empty=True)",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "colWidth": 12,
               "editorMode": "ace/mode/python",
               "results": {},
               "enabled": true,
               "editorSetting": {
                   "language": "python",
                   "editOnDblClick": false,
                   "completionKey": "TAB",
                   "completionSupport": true
               },
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "apps": [],
           "jobName": "paragraph_1557170691615_-911301547",
           "id": "20180824-163321_450981945",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:255"
       },
       {
           "text": "%md\nAfter printing the number of partitions, the partitioner, and the partitions structure, answer the following question:\n\n+ In this case, what is the best approach?\n+ How can you determine that?\n",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:31:53+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true,
                   "completionSupport": false
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<p>After printing the number of partitions, the partitioner, and the partitions structure, answer the following question:</p>\n<ul>\n  <li>In this case, what is the best approach?</li>\n  <li>How can you determine that?</li>\n</ul>\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691615_-829082544",
           "id": "20180824-163507_1092132855",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "FINISHED",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:256",
           "dateFinished": "2019-05-06T19:31:53+0000",
           "dateStarted": "2019-05-06T19:31:53+0000"
       },
       {
           "text": "%md\nAs you can see, repartitioning has a direct effect on the distribution of the information, and using the correct column is essential. To understand which is the most appropriate column for a given dataset, you need to be familiar with the data and analyze its characteristics. There is no “golden” rule that we can give you here.",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:32:04+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true,
                   "completionSupport": false
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<p>As you can see, repartitioning has a direct effect on the distribution of the information, and using the correct column is essential. To understand which is the most appropriate column for a given dataset, you need to be familiar with the data and analyze its characteristics. There is no “golden” rule that we can give you here.</p>\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691616_1912211800",
           "id": "20180824-163550_767573207",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "FINISHED",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:257",
           "dateFinished": "2019-05-06T19:32:04+0000",
           "dateStarted": "2019-05-06T19:32:04+0000"
       },
       {
           "text": "%md\n# Example 3 - I/O with single and multiple files\n\nLet’s now focus our attention on reading and writing. You already know I/O is costly. Regardless, there are strategies for improving I/O performance. This exercise requires you to read and write a `DataSet` in a single file and multiple files to compare performance.",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:32:20+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true,
                   "completionSupport": false
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<h1>Example 3 - I/O with single and multiple files</h1>\n<p>Let’s now focus our attention on reading and writing. You already know I/O is costly. Regardless, there are strategies for improving I/O performance. This exercise requires you to read and write a <code>DataSet</code> in a single file and multiple files to compare performance.</p>\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691617_1407751401",
           "id": "20180824-163615_1064210426",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "FINISHED",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:258",
           "dateFinished": "2019-05-06T19:32:20+0000",
           "dateStarted": "2019-05-06T19:32:20+0000"
       },
       {
           "text": "%md\nFirst, let’s read the data. The dataset is quite big, so let’s take a small sample instead:",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:32:33+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true,
                   "completionSupport": false
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<p>First, let’s read the data. The dataset is quite big, so let’s take a small sample instead:</p>\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691617_238785608",
           "id": "20180827-165943_350742125",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "FINISHED",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:259",
           "dateFinished": "2019-05-06T19:32:33+0000",
           "dateStarted": "2019-05-06T19:32:33+0000"
       },
       {
           "text": "%md <img src=\"https://image.ibb.co/nRs6Nz/scala.png\" alt=\"Scala\">",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<img src=\"https://image.ibb.co/nRs6Nz/scala.png\" alt=\"Scala\">\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691618_-1593789267",
           "id": "20180913-193359_1065759895",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:260"
       },
       {
           "text": "val df = spark.read.json(\"gs://de-training-input/alimazon/50000/client-orders/*.gz\")\n    .sample(false, 0.2) // take 20% of the data without replacement\ndf.count()",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "colWidth": 12,
               "editorMode": "ace/mode/scala",
               "results": {},
               "enabled": true,
               "editorSetting": {
                   "language": "scala",
                   "editOnDblClick": false,
                   "completionKey": "TAB",
                   "completionSupport": true
               },
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "apps": [],
           "jobName": "paragraph_1557170691623_2092583681",
           "id": "20180827-170048_1570856632",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:261"
       },
       {
           "text": "%md <img src=\"https://image.ibb.co/k8qhvK/python.png\" alt=\"Python\">",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<img src=\"https://image.ibb.co/k8qhvK/python.png\" alt=\"Python\">\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691625_677660902",
           "id": "20180913-193408_1073902466",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:262"
       },
       {
           "text": "%pyspark\ndf = spark.read.json(\"gs://de-training-input/alimazon/50000/client-orders/*.gz\") \\\n    .sample(False, 0.2)  # take 20% of the data without replacement\ndf.count()",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "colWidth": 12,
               "editorMode": "ace/mode/python",
               "results": {},
               "enabled": true,
               "editorSetting": {
                   "language": "python",
                   "editOnDblClick": false,
                   "completionKey": "TAB",
                   "completionSupport": true
               },
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "apps": [],
           "jobName": "paragraph_1557170691629_-278845439",
           "id": "20180827-172725_2084099563",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:263"
       },
       {
           "text": "%md\n**`NOTE:`** Do not forget to set your username here. You will need it to write into your output bucket.",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:33:09+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true,
                   "completionSupport": false
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<p><strong><code>NOTE:</code></strong> Do not forget to set your username here. You will need it to write into your output bucket.</p>\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691631_1048090113",
           "id": "20180827-171324_1624649057",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "FINISHED",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:264",
           "dateFinished": "2019-05-06T19:33:09+0000",
           "dateStarted": "2019-05-06T19:33:09+0000"
       },
       {
           "text": "%md <img src=\"https://image.ibb.co/nRs6Nz/scala.png\" alt=\"Scala\">",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<img src=\"https://image.ibb.co/nRs6Nz/scala.png\" alt=\"Scala\">\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691632_1334325128",
           "id": "20180913-193550_1933496446",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:265"
       },
       {
           "text": "val username = \"...\"",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "colWidth": 12,
               "editorMode": "ace/mode/scala",
               "results": {},
               "enabled": true,
               "editorSetting": {
                   "language": "scala",
                   "editOnDblClick": false,
                   "completionKey": "TAB",
                   "completionSupport": true
               },
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "apps": [],
           "jobName": "paragraph_1557170691636_345480265",
           "id": "20180827-171640_353868380",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:266"
       },
       {
           "text": "%md <img src=\"https://image.ibb.co/k8qhvK/python.png\" alt=\"Python\">",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<img src=\"https://image.ibb.co/k8qhvK/python.png\" alt=\"Python\">\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691636_-1801644670",
           "id": "20180913-193605_699867062",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:267"
       },
       {
           "text": "%pyspark\nusername = \"...\"",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "colWidth": 12,
               "editorMode": "ace/mode/python",
               "results": {},
               "enabled": true,
               "editorSetting": {
                   "language": "python",
                   "editOnDblClick": false,
                   "completionKey": "TAB",
                   "completionSupport": true
               },
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "apps": [],
           "jobName": "paragraph_1557170691637_-1217915319",
           "id": "20180827-173600_941913882",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:268"
       },
       {
           "text": "%md\nLet’s write our data using different partitions. Run the code below and confirm in your bucket that the dataset was written in the number of specified partitions.",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:33:20+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true,
                   "completionSupport": false,
                   "completionKey": "TAB"
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<p>Let’s write our data using different partitions. Run the code below and confirm in your bucket that the dataset was written in the number of specified partitions.</p>\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691638_646884625",
           "id": "20180827-170049_2139323805",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "FINISHED",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:269",
           "dateFinished": "2019-05-06T19:33:20+0000",
           "dateStarted": "2019-05-06T19:33:20+0000"
       },
       {
           "text": "%md <img src=\"https://image.ibb.co/nRs6Nz/scala.png\" alt=\"Scala\">",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<img src=\"https://image.ibb.co/nRs6Nz/scala.png\" alt=\"Scala\">\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691639_1265297865",
           "id": "20180913-193622_1360243425",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:270"
       },
       {
           "text": "df.repartition(1).write.json(s\"gs://de-training-output-$username/exercises/c5/client-orders-1-part/\")\ndf.repartition(6).write.json(s\"gs://de-training-output-$username/exercises/c5/client-orders-6-part/\")",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "colWidth": 12,
               "editorMode": "ace/mode/scala",
               "results": {},
               "enabled": true,
               "editorSetting": {
                   "language": "scala",
                   "editOnDblClick": false,
                   "completionKey": "TAB",
                   "completionSupport": true
               },
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "apps": [],
           "jobName": "paragraph_1557170691645_-567871969",
           "id": "20180827-173626_223417974",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:271"
       },
       {
           "text": "%md <img src=\"https://image.ibb.co/k8qhvK/python.png\" alt=\"Python\">",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<img src=\"https://image.ibb.co/k8qhvK/python.png\" alt=\"Python\">\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691647_919651670",
           "id": "20180913-193632_352366408",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:272"
       },
       {
           "text": "%pyspark\ndf.repartition(1).write.json(\"gs://de-training-output-{}/exercises/c5/client-orders-1-part/\".format(username))\ndf.repartition(6).write.json(\"gs://de-training-output-{}/exercises/c5/client-orders-6-part/\".format(username))",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "colWidth": 12,
               "editorMode": "ace/mode/python",
               "results": {},
               "enabled": true,
               "editorSetting": {
                   "language": "python",
                   "editOnDblClick": false,
                   "completionKey": "TAB",
                   "completionSupport": true
               },
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "apps": [],
           "jobName": "paragraph_1557170691647_-889883215",
           "id": "20180827-171201_1462543897",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:273"
       },
       {
           "text": "%md\nLet’s experiment a bit more by reading,writing, and using different numbers of partitions. Let’s try writing by using just one partition as the following snippet shows:",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:33:41+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true,
                   "completionSupport": false
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<p>Let’s experiment a bit more by reading,writing, and using different numbers of partitions. Let’s try writing by using just one partition as the following snippet shows:</p>\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691648_1549470506",
           "id": "20180827-192903_1248488032",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "FINISHED",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:274",
           "dateFinished": "2019-05-06T19:33:41+0000",
           "dateStarted": "2019-05-06T19:33:41+0000"
       },
       {
           "text": "%md <img src=\"https://image.ibb.co/nRs6Nz/scala.png\" alt=\"Scala\">",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<img src=\"https://image.ibb.co/nRs6Nz/scala.png\" alt=\"Scala\">\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691651_-844988860",
           "id": "20180913-193644_1303454298",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:275"
       },
       {
           "text": "val df1 = spark.read.json(s\"gs://de-training-output-$username/exercises/c5/client-orders-1-part/\")\ndf1.repartition(1).write.csv(s\"gs://de-training-output-$username/exercises/c5/client-orders-1-in-1out/\")",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "colWidth": 12,
               "editorMode": "ace/mode/scala",
               "results": {},
               "enabled": true,
               "editorSetting": {
                   "language": "scala",
                   "editOnDblClick": false,
                   "completionKey": "TAB",
                   "completionSupport": true
               },
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "apps": [],
           "jobName": "paragraph_1557170691652_1211749991",
           "id": "20180827-171820_27449283",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:276"
       },
       {
           "text": "%md <img src=\"https://image.ibb.co/k8qhvK/python.png\" alt=\"Python\">",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<img src=\"https://image.ibb.co/k8qhvK/python.png\" alt=\"Python\">\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691652_1276635558",
           "id": "20180913-193701_1652114558",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:277"
       },
       {
           "text": "%pyspark\ndf1 = sqlContext.read.json(\"gs://de-training-output-{}/exercises/c5/client-orders-1-part/\".format(username))\ndf1.repartition(1).write.csv(\"gs://de-training-output-{}/exercises/c5/client-orders-1-in-1out/\".format(username))",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "colWidth": 12,
               "editorMode": "ace/mode/python",
               "results": {},
               "enabled": true,
               "editorSetting": {
                   "language": "python",
                   "editOnDblClick": false,
                   "completionKey": "TAB",
                   "completionSupport": true
               },
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "apps": [],
           "jobName": "paragraph_1557170691655_-1377300227",
           "id": "20180827-173824_1583828117",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:278"
       },
       {
           "text": "%md\nHere is the example for reading from multiple files and writing to multiple files:",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:33:51+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true,
                   "completionSupport": false
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<p>Here is the example for reading from multiple files and writing to multiple files:</p>\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691656_-2050471557",
           "id": "20180827-171903_233529514",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "FINISHED",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:279",
           "dateFinished": "2019-05-06T19:33:51+0000",
           "dateStarted": "2019-05-06T19:33:51+0000"
       },
       {
           "text": "%md <img src=\"https://image.ibb.co/nRs6Nz/scala.png\" alt=\"Scala\">",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<img src=\"https://image.ibb.co/nRs6Nz/scala.png\" alt=\"Scala\">\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691656_-1782168736",
           "id": "20180913-193724_732049143",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:280"
       },
       {
           "text": "val df6 = spark.read.json(s\"gs://de-training-output-$username/exercises/c5/client-orders-6-part/\")\ndf6.repartition(6).write.csv(s\"gs://de-training-output-$username/exercises/c5/client-orders-6-in-6-out/\")",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "colWidth": 12,
               "editorMode": "ace/mode/scala",
               "results": {},
               "enabled": true,
               "editorSetting": {
                   "language": "scala",
                   "editOnDblClick": false,
                   "completionKey": "TAB",
                   "completionSupport": true
               },
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "apps": [],
           "jobName": "paragraph_1557170691657_-1106104186",
           "id": "20180827-172046_737696731",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:281"
       },
       {
           "text": "%md <img src=\"https://image.ibb.co/k8qhvK/python.png\" alt=\"Python\">",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<img src=\"https://image.ibb.co/k8qhvK/python.png\" alt=\"Python\">\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691658_-2011238947",
           "id": "20180913-193733_1564941392",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:282"
       },
       {
           "text": "%pyspark\ndf6 = sqlContext.read.json(\"gs://de-training-output-{}/exercises/c5/client-orders-6-part/\".format(username))\ndf6.repartition(6).write.csv(\"gs://de-training-output-{}/exercises/c5/client-orders-6-in-6-out/\".format(username))",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "colWidth": 12,
               "editorMode": "ace/mode/python",
               "results": {},
               "enabled": true,
               "editorSetting": {
                   "language": "python",
                   "editOnDblClick": false,
                   "completionKey": "TAB",
                   "completionSupport": true
               },
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "apps": [],
           "jobName": "paragraph_1557170691667_1896059993",
           "id": "20180827-174103_2146116059",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:283"
       },
       {
           "text": "%md \n### Exercise\n\nExplore using different number of partitions, reading from 1 file and writing to 4 files, and answer:\n\n+ Which option is faster? \n+ Can you explain why?\n",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:34:14+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true,
                   "completionSupport": false
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<h3>Exercise</h3>\n<p>Explore using different number of partitions, reading from 1 file and writing to 4 files, and answer:</p>\n<ul>\n  <li>Which option is faster?</li>\n  <li>Can you explain why?</li>\n</ul>\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691668_-1000439449",
           "id": "20180827-172131_750013194",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "FINISHED",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:284",
           "dateFinished": "2019-05-06T19:34:14+0000",
           "dateStarted": "2019-05-06T19:34:14+0000"
       },
       {
           "text": "%md\n# Example 4 - Looking at Partitions Size\n\n",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:34:25+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true,
                   "completionSupport": false
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<h1>Example 4 - Looking at Partitions Size</h1>\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691668_-955402670",
           "id": "20180824-163816_107227786",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "FINISHED",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:285",
           "dateFinished": "2019-05-06T19:34:25+0000",
           "dateStarted": "2019-05-06T19:34:25+0000"
       },
       {
           "text": "%md <img src=\"https://image.ibb.co/nRs6Nz/scala.png\" alt=\"Scala\">",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<img src=\"https://image.ibb.co/nRs6Nz/scala.png\" alt=\"Scala\">\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691669_-320415108",
           "id": "20180913-193753_181791138",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:286"
       },
       {
           "text": "import org.apache.spark.sql.Row\nimport org.apache.spark.sql.types.{IntegerType, StructField, StructType}\n\nval sampleDataSet = ((1 to 100000).map((_,0))++(1 to 100).flatMap(i => (1 to 100).map((_,i)))).toDS.cache\nprintln(\"Number of partitions: ${sampleDataSet.rdd.getNumPartitions}\")\n\nval schema = new StructType()\n  .add(StructField(\"index\", IntegerType, /* nullable: */ false))\n  .add(StructField(\"value\", IntegerType, /* nullable: */ false))\n  \nval partitions = sampleDataSet.rdd.mapPartitionsWithIndex(\n    (index, partition) => List(Row(index, partition.size)).toIterator)\n\nspark.createDataFrame(partitions, schema).show()",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "colWidth": 12,
               "editorMode": "ace/mode/scala",
               "results": {},
               "enabled": true,
               "editorSetting": {
                   "language": "scala",
                   "editOnDblClick": false,
                   "completionKey": "TAB",
                   "completionSupport": true
               },
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "apps": [],
           "jobName": "paragraph_1557170691670_794205979",
           "id": "20180824-163856_1912329826",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:287"
       },
       {
           "text": "%md <img src=\"https://image.ibb.co/k8qhvK/python.png\" alt=\"Python\">",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<img src=\"https://image.ibb.co/k8qhvK/python.png\" alt=\"Python\">\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691670_-1307311722",
           "id": "20180913-193802_601181425",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:288"
       },
       {
           "text": "%pyspark\nfrom itertools import chain\nfrom pyspark.sql import Row\n\nsample_dataset = spark.createDataFrame(chain([(i, 0) for i in range(1, 100001)], [(i, j) for i in range(1, 101) for j in range(1, 101)])).cache()\nprint(\"Number of partitions: {}\".format(sample_dataset.rdd.getNumPartitions()))\n\npartitions = sample_dataset.rdd.mapPartitionsWithIndex(lambda index, partition: [Row(index=index, value=len(list(partition)))])\nspark.createDataFrame(partitions).show()",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "colWidth": 12,
               "editorMode": "ace/mode/python",
               "results": {},
               "enabled": true,
               "editorSetting": {
                   "language": "python",
                   "editOnDblClick": false,
                   "completionKey": "TAB",
                   "completionSupport": true
               },
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "apps": [],
           "jobName": "paragraph_1557170691671_-382150196",
           "id": "20180827-174300_1370563640",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:289"
       },
       {
           "text": "%md\n### Exercise\nUsing what you learned in former sessions, in previous examples, and in exercises:\n\n+ Load the flights dataset and display the size of each partition.\n+ Can you find a way to repartition the dataset so as to achieve an even distribution of the data?\n",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:34:52+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "markdown",
                   "editOnDblClick": true,
                   "completionSupport": false
               },
               "colWidth": 12,
               "editorMode": "ace/mode/markdown",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "results": {
               "code": "SUCCESS",
               "msg": [
                   {
                       "type": "HTML",
                       "data": "<div class=\"markdown-body\">\n<h3>Exercise</h3>\n<p>Using what you learned in former sessions, in previous examples, and in exercises:</p>\n<ul>\n  <li>Load the flights dataset and display the size of each partition.</li>\n  <li>Can you find a way to repartition the dataset so as to achieve an even distribution of the data?</li>\n</ul>\n</div>"
                   }
               ]
           },
           "apps": [],
           "jobName": "paragraph_1557170691671_1646162180",
           "id": "20180824-163919_2039405814",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "FINISHED",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:290",
           "dateFinished": "2019-05-06T19:34:52+0000",
           "dateStarted": "2019-05-06T19:34:52+0000"
       },
       {
           "text": "",
           "user": "anonymous",
           "dateUpdated": "2019-05-06T19:24:51+0000",
           "config": {
               "tableHide": false,
               "editorSetting": {
                   "language": "scala",
                   "editOnDblClick": true
               },
               "colWidth": 12,
               "editorMode": "ace/mode/scala",
               "editorHide": true,
               "results": {},
               "enabled": true,
               "fontSize": 9
           },
           "settings": {
               "params": {},
               "forms": {}
           },
           "apps": [],
           "jobName": "paragraph_1557170691672_-2087943985",
           "id": "20180824-163954_1813225578",
           "dateCreated": "2019-05-06T19:24:51+0000",
           "status": "READY",
           "errorMessage": "",
           "progressUpdateIntervalMs": 500,
           "$$hashKey": "object:291"
       }
   ],
   "name": "c5-examples-exercises",
   "id": "2EBE59P7V",
   "noteParams": {},
   "noteForms": {},
   "angularObjects": {},
   "config": {
       "isZeppelinNotebookCronEnable": false,
       "looknfeel": "default",
       "personalizedMode": "false"
   },
   "info": {}
}